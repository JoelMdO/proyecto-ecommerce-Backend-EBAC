{%load static %}
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
<script>
  function renderChart(labels, data) {
    const ctx = document.getElementById("salesChart").getContext("2d");
    new Chart(ctx, {
      type: "polarArea",
      data: {
        labels: labels,
        datasets: [
          {
            label: "Sales",
            data: data,
            backgroundColor: "rgba(54, 162, 235, 0.5)",
          },
        ],
      },
    });
  }

  function getSalesData(type) {
    const url = "/sales/sales/chart/data";
    $.ajax({
      url: url,
      method: "GET",
      data: { type: type },
      success: function (response) {
        console.log("Data received:", response);
        renderChart(response.labels, response.data);
      },
      error: function (xhr, status, error) {
        console.error("AJAX error:", status, error);
        alert("Ocurri√≥ un error: " + error);
      },
    });
  }

  $(document).ready(function () {
    console.log("Page loaded, Chart available:", typeof Chart !== "undefined");
    const canvas = document.getElementById("salesChart");
    if (canvas) {
      console.log("Canvas found");
      const type = canvas.getAttribute("data-type") || "week";
      getSalesData(type);
    } else {
      console.error("Canvas not found");
    }
  });
</script>
